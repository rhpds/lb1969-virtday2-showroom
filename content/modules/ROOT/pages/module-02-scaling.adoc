= Real world scaling scenario

//, new capacity demands (45 minutes)
In this sections we will be going over vertical, horizontal scaling and looking at the graphs, logs and alerts.

//, == Performance and Observability

//, === Examine Load on Virtual Guests

//, === Example graphs, logs, and alerts.

== Horizontally Scaling

. For this part of the lab we need to make sure that the load maker pod is running

+
. Click on *Workloads* > *Deployments* > *loadmaker*. Ensure you are in Project: *windows-vms*.
+
image::day-to-day/select_loadmaker.png[link=self, window=blank, width=100%]
+
. You should see 1 Pod under the Deployment Details tab.
+
image::day-to-day/show_num_pod.png[link=self, window=blank, width=100%]
+
. Click on *Environment* tab
+
image::day-to-day/lm_pod_config.png[link=self, window=blank, width=100%]
+
. In *Virtualization* > *VirtualMachine* Select *windows-vms* project to show *winweb01*, *winweb02* and *database*. You should see high resource usage on *winweb01*.
+
image::day-to-day/before_upgrade_horizontally.png[link=self, window=blank, width=100%]
+
. Make sure you are still on *windows-vms* projeect and click on *winweb01* 
+
image::day-to-day/before_selectedvm.png[link=self, window=blank, width=100%]
+
. Click on the *metrics* tab and *CPU* graph. You will see the spike in resource usage go up as the loadmakeris running. Now lets bring down those resources with powering on the second winweb vm.
+
image::day-to-day/winweb01_select_cpu.png[link=self, window=blank, width=100%]
+
. Click on the checkbox next to *winweb02*, Click on *Actions* > *Start* to power on *winweb02*
+
image::day-to-day/power_on.png[link=self, window=blank, width=100%]
+
. After approximently 5 minutes the load will even itself out between both winweb servers.
+
image::day-to-day/vm_add_horizontally.png[link=self, window=blank, width=100%]
+
. Now lets go back to *winweb01* > Click on *Metrics* > Click on *CPU* graph.
+
image::day-to-day/after_poweron.png[link=self, window=blank, width=100%]

=== Vertically Scaling

. Click on the *winweb01*.
+
image::day-to-day/select_vm.png[link=self, window=blank, width=100%]
+
. Click on the *Configuration* tab
+
image::day-to-day/select_config.png[link=self, window=blank, width=100%]
+
. In the VIrtualMachine Details under CPU | Memory section Click on *2 CPU | 1 Gib Memory*
+
image::day-to-day/edit_vm.png[link=self, window=blank, width=100%]
+
. Increase the vCPUs to *8* and Memory to *4* and Click *Save*.
+
image::day-to-day/update_specs.png[link=self, window=blank, width=100%]
+
. Click back on the *Overview* tab. You will see that the CPU | Memory section in the details has been updated to the new values.
+
image::day-to-day/vm_new_spec.png[link=self, window=blank, width=100%]
+
. Repeat these steps for *winweb02*.

. Once both vms are upgraded in the project tree view click on *windows-vms* project. You will see that the CPU and Memory usage has gone down.
+
image::day-to-day/updated_usage.png[link=self, window=blank, width=100%]
+
. Let head back to *winweb01* and look at its metrics afters the CPU increase. Click on *Metrics* > Click on *CPU* graph.
+
image::day-to-day/updated_usage_verify.png[link=self, window=blank, width=100%]

=== Enable Swap/Memory Overcommit

. Under *Virtualization* > *ViirtalMachines* make sure all vms in *vms=aap=day2* and *windows-vms* are powered on. You should see a green arrow to thr left of the vm name.
+
image::day-to-day/verify_oc.png[link=self, window=blank, width=100%]
+
. Click on *mass=vm* project. Click on *1 - 15 of 30* drop down and change it to *50 per page*
+
image::day-to-day/project_mass.png[link=self, window=blank, width=100%]
+
. Click on the Check box under filter to select all vms. Click on *Actions* and *Start*
+
image::day-to-day/select_all.png[link=self, window=blank, width=100%]
+
. After the vms start to power on there should be approximently 7 vms that have errors.
+
image::day-to-day/after_start.png[link=self, window=blank, width=100%]
+
. Click on the number of errors
+
image::day-to-day/num_errors.png[link=self, window=blank, width=100%]
+
. These VMs will show a ErrorUnschedulable in the status column.
. Click on *Compute* then *Nodes*. Select the worker-1 node.
+
image::day-to-day/worker_node.png[link=self, window=blank, width=100%]
+
. Click on *Details* and scroll down until you see Taints
+
image::day-to-day/node_details.png[link=self, window=blank, width=100%]
+
. Click on the *pencil icon*.
+
image::day-to-day/select_taints.png[link=self, window=blank, width=100%]
+
. Remove on the *-* to remove and *Save*.
+
image::day-to-day/remove_taint.png[link=self, window=blank, width=100%]
+
. Once the taint is remove go back to the *Virtualmachine* and go to the *mass-vm* porject
. Click the check box for select all VMs and click on *Actions* and *Start*
. You will start to see the VMs powering on. This will take a few minutes to start.
+
image::day-to-day/massvm_running_total.png[link=self, window=blank, width=100%]

== New gear arrives

=== Live Migrate Backend VMs (remove or tolerate node taint)
